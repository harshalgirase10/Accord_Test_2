---
- name: Create a test file on a remote Windows host
  hosts: windows
  tasks:

      - name: Ensure the target directory exists
        ansible.windows.win_file:
            path: C:\TestDirectory
            state: directory

      - name: Create a test file
        ansible.windows.win_copy:
          content: "This is a test file created by Ansible. | this is from action"
          dest: C:\TestDirectory\testfile.txt

      - name: Download Python installer
        win_get_url:
          url: https://www.python.org/ftp/python/3.12.0/python-3.12.0-amd64.exe
          dest: C:\Temp\python-installer.exe
          validate_certs: no
  
      - name: Install Python
        win_package:
          path: C:\Temp\python-installer.exe
          arguments: /quiet InstallAllUsers=1 PrependPath=1
          state: present
  
      - name: Verify Python installation
        win_shell: python --version
        register: python_version
  
      - name: Display Python version
        debug:
          msg: "Python installed successfully. Version: {{ python_version.stdout }}"
